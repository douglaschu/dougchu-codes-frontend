---
import { getPost, getPosts } from "../../lib/payload";

export async function getStaticPaths() {
     const posts = await getPosts();
     return posts.map((post: any) => ({
          params: { slug: post.slug },
     }));
}

const { slug } = Astro.params;
const post = await getPost(slug!);

if (!post) {
     return Astro.redirect("/404");
}
---

<html lang="en">
     <head>
          <meta charset="UTF-8" />
          <title>{post.title}</title>
     </head>
     <body>
          <article>
               <h1>{post.title}</h1>
               <time
                    >{
                         new Date(post.publishedAt).toLocaleDateString(
                              "en-US",
                              {
                                   year: "numeric",
                                   month: "long",
                                   day: "numeric",
                              }
                         )
                    }</time
               >
               <!-- <div set:html={post.contentHTML} /> -->
               <div set:html={post.contentHTML} />
          </article>
          <a href="/blog">‚Üê Back to blog</a>
     </body>
</html>
